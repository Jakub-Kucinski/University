"0","sigma = 1"
"0","n = 1000"
"0","p = 950"
"0","# sigma_matrix = matrix(rep(0.5, 950*950), nrow=950)"
"0","# diag(sigma_matrix) = 1"
"0","# sigma_matrix = sigma_matrix / n"
"0","# X = rmvnorm(n, rep(0, p), sigma_matrix)"
"0","beta = c(rep(0, p))"
"0","non_zero_beta_val = 3.5"
"0","ks = c(20, 100, 200)"
"0",""
"0","names_of_columns = c(""k"", ""beta_mse_sure_ridge"", ""beta_mse_sure_lasso"", ""beta_mse_sure_elnet"", ""beta_mse_crossval_ridge"", ""beta_mse_crossval_lasso"","
"0","                     ""beta_mse_crossval_elnet"", ""beta_mse_ols"", ""beta_mse_aic"", ""beta_mse_mbic2"")"
"0","mse_betas = data.frame(matrix(ncol=length(names_of_columns), nrow=0))"
"0","colnames(mse_betas) = names_of_columns"
"0",""
"0","names_of_columns = c(""k"", ""mean_mse_sure_ridge"", ""mean_mse_sure_lasso"", ""mean_mse_sure_elnet"", ""mean_mse_crossval_ridge"", ""mean_mse_crossval_lasso"","
"0","                     ""mean_mse_crossval_elnet"", ""mean_mse_ols"", ""mean_mse_aic"", ""mean_mse_mbic2"")"
"0","mse_mean = data.frame(matrix(ncol=length(names_of_columns), nrow=0))"
"0","colnames(mse_mean) = names_of_columns"
"0",""
"0","n_experiments = 100"
"0","for(i in 1:length(ks)){"
"0","    k = ks[i]"
"0","    e = rnorm(n)"
"0","    beta[1:k] = non_zero_beta_val"
"0","    Y = X %*% beta + e"
"0","    "
"0","    beta_mse_sure_ridge = 0"
"0","    beta_mse_sure_lasso = 0"
"0","    beta_mse_sure_elnet = 0"
"0","    beta_mse_crossval_ridge = 0"
"0","    beta_mse_crossval_lasso = 0"
"0","    beta_mse_crossval_elnet = 0"
"0","    beta_mse_ols = 0"
"0","    beta_mse_aic = 0"
"0","    beta_mse_mbic2 = 0"
"0","    "
"0","    mean_mse_sure_ridge = 0"
"0","    mean_mse_sure_lasso = 0"
"0","    mean_mse_sure_elnet = 0"
"0","    mean_mse_crossval_ridge = 0"
"0","    mean_mse_crossval_lasso = 0"
"0","    mean_mse_crossval_elnet = 0"
"0","    mean_mse_ols = 0"
"0","    mean_mse_aic = 0"
"0","    mean_mse_mbic2 = 0"
"0","    "
"0","    # optimal_lambdas: ""k"", ""lambda_sure_ridge"", ""lambda_sure_lasso"", ""lambda_sure_elnet"", ""lambda_crossval_ridge"", ""lambda_crossval_lasso"", ""lambda_crossval_elnet"""
"0","    "
"0","    for (i_exp in 1:n_experiments){"
"0","        "
"0","        # SURE RIDGE"
"0","        lambda = optimal_lambdas[i, 2]"
"0","        obj_ridge = glmnet(X, Y, alpha=0, intercept=FALSE, standardize=FALSE, lambda=lambda)"
"0","        beta_hat = coefficients(obj_ridge)"
"0","        beta_hat = beta_hat[2:(p+1),1]"
"0","        beta_mse_sure_ridge = beta_mse_sure_ridge + sum((beta_hat - beta)^2)"
"0","        mean_mse_sure_ridge = mean_mse_sure_ridge + sum((X%*%beta_hat - X%*%beta)^2)"
"0","        "
"0","        # SURE LASSO"
"0","        lambda = optimal_lambdas[i, 3]"
"0","        obj_lasso = glmnet(X, Y, alpha=1, intercept=FALSE, standardize=FALSE, lambda=lambda)"
"0","        beta_hat = coefficients(obj_lasso)"
"0","        beta_hat = beta_hat[2:(p+1),1]"
"0","        beta_mse_sure_lasso = beta_mse_sure_lasso + sum((beta_hat - beta)^2)"
"0","        mean_mse_sure_lasso = mean_mse_sure_lasso + sum((X%*%beta_hat - X%*%beta)^2)"
"0","        "
"0","        # SURE ELASTICNET"
"0","        lambda = optimal_lambdas[i, 4]"
"0","        obj_elnet = glmnet(X, Y, alpha=0.5, intercept=FALSE, standardize=FALSE, lambda=lambda)"
"0","        beta_hat = coefficients(obj_elnet)"
"0","        beta_hat = beta_hat[2:(p+1),1]"
"0","        beta_mse_sure_elnet = beta_mse_sure_elnet + sum((beta_hat - beta)^2)"
"0","        mean_mse_sure_elnet = mean_mse_sure_elnet + sum((X%*%beta_hat - X%*%beta)^2)"
"0","        "
"0","        #CROSSVALIDATION RIDGE"
"0","        lambda = optimal_lambdas[i, 5]"
"0","        obj_ridge = glmnet(X, Y, alpha=0, intercept=FALSE, standardize=FALSE, lambda=lambda)"
"0","        beta_hat = coefficients(obj_ridge)"
"0","        beta_hat = beta_hat[2:(p+1),1]"
"0","        beta_mse_crossval_ridge = beta_mse_crossval_ridge + sum((beta_hat - beta)^2)"
"0","        mean_mse_crossval_ridge = mean_mse_crossval_ridge + sum((X%*%beta_hat - X%*%beta)^2)"
"0","        "
"0","        # CROSSVALIDATION LASSO"
"0","        lambda = optimal_lambdas[i, 6]"
"0","        obj_lasso = glmnet(X, Y, alpha=1, intercept=FALSE, standardize=FALSE, lambda=lambda)"
"0","        beta_hat = coefficients(obj_lasso)"
"0","        beta_hat = beta_hat[2:(p+1),1]"
"0","        beta_mse_crossval_lasso = beta_mse_crossval_lasso + sum((beta_hat - beta)^2)"
"0","        mean_mse_crossval_lasso = mean_mse_crossval_lasso + sum((X%*%beta_hat - X%*%beta)^2)"
"0","        "
"0","        # CROSSVALIDATION ELASTICNET"
"0","        lambda = optimal_lambdas[i, 7]"
"0","        obj_elnet = glmnet(X, Y, alpha=0.5, intercept=FALSE, standardize=FALSE, lambda=lambda)"
"0","        beta_hat = coefficients(obj_elnet)"
"0","        beta_hat = beta_hat[2:(p+1),1]"
"0","        beta_mse_crossval_elnet = beta_mse_crossval_elnet + sum((beta_hat - beta)^2)"
"0","        mean_mse_crossval_elnet = mean_mse_crossval_elnet + sum((X%*%beta_hat - X%*%beta)^2)"
"0","        "
"0","        # OLS"
"0","        beta_hat = lm(Y~X-1)$coefficients"
"0","        beta_mse_ols = beta_mse_ols + sum((beta_hat - beta)^2)"
"0","        mean_mse_ols = mean_mse_ols + sum((X%*%beta_hat - X%*%beta)^2)"
"0",""
"0","        # OLS AIC"
"0","        d=prepare_data(Y, X, verbose = FALSE)"
"0","        obj_aic = fast_forward(d, crit=aic)"
"0","        s_obj_aic <- summary(obj_aic)"
"0","        beta_hat <- rep(0, 950)"
"0","        if(length(obj_aic$model) > 0){"
"0","          beta_hat[as.numeric(obj_aic$model)] <- s_obj_aic$coefficients[-1, 1]"
"0","        }"
"0","        beta_mse_aic = beta_mse_aic + sum((beta_hat - beta)^2)"
"0","        mean_mse_aic = mean_mse_aic + sum((X%*%beta_hat - X%*%beta)^2)"
"0",""
"0","        # OLS MBIC2"
"0","        d=prepare_data(Y, X, verbose = FALSE)"
"0","        obj_mbic2 = fast_forward(d, crit=mbic2)"
"0","        s_obj_mbic2 <- summary(obj_mbic2)"
"0","        beta_hat <- rep(0, 950)"
"0","        if(length(obj_mbic2$model) > 0){"
"0","          beta_hat[as.numeric(obj_mbic2$model)] <- s_obj_mbic2$coefficients[-1, 1]"
"0","        }"
"0","        beta_mse_mbic2 = beta_mse_mbic2 + sum((beta_hat - beta)^2)"
"0","        mean_mse_mbic2 = mean_mse_mbic2 + sum((X%*%beta_hat - X%*%beta)^2)"
"0","    }"
"0","    mse_betas[nrow(mse_betas) + 1,] = c(k, beta_mse_sure_ridge/n_experiments, beta_mse_sure_lasso/n_experiments, beta_mse_sure_elnet/n_experiments, beta_mse_crossval_ridge/n_experiments, beta_mse_crossval_lasso/n_experiments, beta_mse_crossval_elnet/n_experiments, beta_mse_ols/n_experiments, beta_mse_aic/n_experiments, beta_mse_mbic2/n_experiments)"
"0","    mse_mean[nrow(mse_mean) + 1,] = c(k, mean_mse_sure_ridge/n_experiments, mean_mse_sure_lasso/n_experiments, mean_mse_sure_elnet/n_experiments, mean_mse_crossval_ridge/n_experiments, mean_mse_crossval_lasso/n_experiments, mean_mse_crossval_elnet/n_experiments, mean_mse_ols/n_experiments, mean_mse_aic/n_experiments, mean_mse_mbic2/n_experiments)"
"0","}"
