"0","n = 1000"
"0","sigma = 1.0"
"0","X = matrix(rnorm(950000, 0, 1.0/sqrt(1000)), n, 950)"
"0","e = rnorm(n)"
"0","beta = c(3, 3, 3, 3, 3, rep(0, 945))"
"0","Y = X %*% beta + e"
"0","significance = 0.1"
"0","nvars = c(2, 5, 10, 100, 500, 950)"
"0","nmodels = length(nvars)"
"0","n_experiments = 500"
"0",""
"0","names_of_columns = c(""ncols"", ""RSS"", ""PE"", ""PE_sigma_known"", ""PE_sigma_unknown"", ""PE_cross_valid"", ""AIC_sigma_known"", ""AIC_sigma_unknown"")"
"0","task1 = data.frame(matrix(ncol=length(names_of_columns), nrow=0))"
"0","colnames(task1) = names_of_columns"
"0",""
"0","for (i in 1:nmodels){"
"0","  p = nvars[i]"
"0","  Xi = X[, 1:p]"
"0","  reg = lm(Y~Xi -1, x = TRUE)"
"0",""
"0","  betahat = reg$coefficients"
"0","  RSS = sum(summary(reg)$residuals ^ 2)"
"0","  Y_h = Xi %*% betahat"
"0","  true_expected_value_of_PE = sum((Xi%*%beta[1:p] - Y_h)^2) + n * sigma ** 2"
"0","  M = Xi %*% solve(t(Xi) %*% Xi) %*% t(Xi)"
"0","  estimate_PE_sigma_known = RSS + 2 * sum(diag(M)) * sigma ** 2"
"0","  estimate_PE_sigma_unknown = RSS + 2 * sum(diag(M)) * (RSS / (n-p))"
"0","  PE_leave_one_out_crossvalidation = sum((summary(reg)$residuals / (1 - diag(M)))**2)"
"0","  aic_sigma_known = - n * log(sqrt(2 * pi)) - RSS/2 - p"
"0","  aic_sigma_unknown = - n * log(sqrt(2 * pi)) - n/2 * log(RSS) - p"
"0","  task1[nrow(task1) + 1,] = c(p, RSS, true_expected_value_of_PE, estimate_PE_sigma_known, estimate_PE_sigma_unknown, PE_leave_one_out_crossvalidation, aic_sigma_known, aic_sigma_unknown)"
"0","}"
"0","task1"
