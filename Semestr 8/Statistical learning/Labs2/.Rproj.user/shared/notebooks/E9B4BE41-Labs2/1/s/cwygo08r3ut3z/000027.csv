"0","measure = function(model, X_train, Y_train, X_test, Y_test){"
"0","  beta_hat = summary(model)$coefficients[,1]"
"0","  SE_train = mean((data.matrix(Y_train) - data.matrix(cbind(rep(1, dim(X_train)[1]), X_train[model$model])) %*% beta_hat)^2)"
"0","  SE_test = mean((data.matrix(Y_test) - data.matrix(cbind(rep(1, dim(X_test)[1]), X_test[model$model])) %*% beta_hat)^2)"
"0","  c(SE_train, SE_test)"
"0","}"
"0",""
"0","names_of_columns = c(""Criterion"", ""No. selected vars"", ""Train MSE"", ""Test MSE"")"
"0","task5 = data.frame(matrix(ncol=length(names_of_columns), nrow=0))"
"0","colnames(task5) = names_of_columns"
"0",""
"0","criteria = list(ric, bic, aic, mbic, mbic2)"
"0","criteria_strings = c(""ric"", ""bic"", ""aic"", ""mbic"", ""mbic2"")"
"0",""
"0","realdata = get(load(""/cloud/project/realdata.Rdata""))"
"0","nrows = dim(realdata)[1]"
"0","ncols = dim(realdata)[2]"
"0",""
"0","train_ind = sample(seq_len(nrows), size=180)"
"0","train = realdata[train_ind, ]"
"0","test = realdata[-train_ind, ]"
"0","Y_train = train[,1]"
"0","Y_train = matrix(Y_train, ncol=1)"
"0","Y_test = test[,1]"
"0","Y_test = matrix(Y_test, ncol=1)"
"0","X_train = train[,2:3221]"
"0","X_test = test[,2:3221]"
"0",""
"0","Y_train = data.frame(Y_train)"
"0","X_train = data.frame(X_train)"
"0","Y_test = data.frame(Y_test)"
"0","X_test = data.frame(X_test)"
"0",""
"0","for (i in 1:length(criteria)){"
"0","  data = prepare_data(Y_train, X_train, verbose=FALSE)"
"0","  result_model = fast_forward(data, crit=criteria[[i]])"
"0","  measurements = measure(result_model, X_train, Y_train, X_test, Y_test)"
"0","  task5[nrow(task5) + 1,] = c(criteria_strings[i], length(result_model$model), measurements[1], measurements[2])"
"0","}"
"0","task5"
