"0","n = 1000"
"0","sigma = 1.0"
"0","beta = c(3, 3, 3, 3, 3, rep(0, 945))"
"0","significance = 0.1"
"0","nvars = c(2, 5, 10, 100, 500, 950)"
"0","nmodels = length(nvars)"
"0","n_experiments = 100"
"0",""
"0","task2 = array(dim=c(n_experiments, 6, 11))"
"0","for (i_exp in 1:n_experiments){"
"0","  X = matrix(rnorm(950000, 0, 1.0/sqrt(1000)), n, 950)"
"0","  e = rnorm(n)"
"0","  Y = X %*% beta + e"
"0","  for (i in 1:nmodels){"
"0","    p = nvars[i]"
"0","    Xi = X[, 1:p]"
"0","    reg = lm(Y~Xi -1, x = TRUE)"
"0","  "
"0","    betahat = reg$coefficients"
"0","    RSS = sum(summary(reg)$residuals ^ 2)"
"0","    Y_h = Xi %*% betahat"
"0","    true_expected_value_of_PE = sum((Xi%*%beta[1:p] - Y_h)^2) + n * sigma ** 2"
"0","    "
"0","    M = Xi %*% solve(t(Xi) %*% Xi) %*% t(Xi)"
"0","    estimate_PE_sigma_known = RSS + 2 * sum(diag(M)) * sigma ** 2"
"0","    estimate_PE_sigma_unknown = RSS + 2 * sum(diag(M)) * (RSS / (n-p))"
"0","    PE_leave_one_out_crossvalidation = sum((summary(reg)$residuals / (1 - diag(M)))**2)"
"0",""
"0","    aic_sigma_known = - n * log(sqrt(2 * pi)) - RSS/2 - p"
"0","    aic_sigma_unknown = - n * log(sqrt(2 * pi)) - n/2 * log(RSS) - p"
"0","    "
"0","    FP_sigma_known = sum(abs(betahat) > sqrt(2) & !(beta != 0)[1:p])"
"0","    FN_sigma_known = sum(!(abs(betahat) > sqrt(2)) & (beta != 0)[1:p])"
"0","    FP_sigma_unknown = sum(abs(betahat) > sqrt(RSS/(n-p)*2) & !(beta != 0)[1:p])"
"0","    FN_sigma_unknown = sum(!(abs(betahat) > sqrt(RSS/(n-p)*2)) & (beta != 0)[1:p])"
"0","  "
"0","    task2[i_exp,i,] = c(RSS, true_expected_value_of_PE, estimate_PE_sigma_known, estimate_PE_sigma_unknown, PE_leave_one_out_crossvalidation, aic_sigma_known, aic_sigma_unknown, FP_sigma_known, FN_sigma_known, FP_sigma_unknown, FN_sigma_unknown)"
"0","  }"
"0","}"
