"0","W2<-abs(betaL)+0.000001;"
"0","Xtemp<-sweep(X,2,W2,'*');"
"0",""
"0","obj3=cv.glmnet(Xtemp,Y,intercept=FALSE,standardize=FALSE);"
"0",""
"0","lambda_min = obj3$lambda.min"
"0","lambda_vec <- seq(from = lambda_min/100, to = lambda_min/3, by = 0.0001)"
"0","res2 <- matrix(0, length(lambda_vec), 2)"
"0","res2[,1] <- lambda_vec"
"0",""
"0","for(i in 1:length(lambda_vec)){"
"0","  obj <- glmnet(Xtemp, Y, alpha = 1, lambda = lambda_vec[i], intercept=FALSE, standardize=FALSE)"
"0","  betaadcv<-coefficients(obj)[2:(p+1),1];"
"0","  betahatad=betaadcv * W2;"
"0","  res2[i,2] <- sum((X%*%(betahatad - beta))^2)"
"0","}"
"0",""
"0","min_lambda_adaptive_lasso_mse <- res2[which.min(res2[,2]),1]"
"0",""
"0","obj <- glmnet(Xtemp, Y, alpha = 1, lambda = min_lambda_adaptive_lasso_mse, intercept=FALSE, standardize=FALSE)"
"0","betaadcv<-coefficients(obj)[2:(p+1),1];"
"0","betahatad=betaadcv * W2;"
"0","min_adaptive_lasso_mse <- sum((X%*%(betahatad - beta))^2)"
"0",""
"0","# print(min_lambda_adaptive_lasso_mse)"
"0","# print(min_adaptive_lasso_mse)"
"0","plot(res2[,2]~res2[,1], log='x', main=""Adaptive LASSO MSE for different values of lambda"")"
