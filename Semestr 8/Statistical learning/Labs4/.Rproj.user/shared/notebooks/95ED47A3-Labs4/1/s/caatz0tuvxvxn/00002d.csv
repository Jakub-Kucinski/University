"0","obj<-cv.glmnet(X,Y);"
"0","lambda_min = obj$lambda.min"
"0","lambda_vec <- seq(from = lambda_min/15, to = lambda_min, by = 0.001)"
"0","# lambda_vec <- logspace(-5, -1, n=100)"
"0","res <- matrix(0, length(lambda_vec), 2)"
"0","res[,1] <- lambda_vec"
"0",""
"0","for(i in 1:length(lambda_vec)){"
"0","  obj <- glmnet(X, Y, alpha = 1, lambda = lambda_vec[i])"
"0","  coef <- coefficients(obj)[2:(p+1),1]"
"0","  res[i,2] <- sum((X%*%(coef - beta))^2)"
"0","}"
"0",""
"0","min_lambda_lasso_mse <- res[which.min(res[,2]),1]"
"0",""
"0","obj <- glmnet(X, Y, alpha = 1, lambda = min_lambda_lasso_mse)"
"0","coef <- coefficients(obj)[2:(p+1),1]"
"0","min_lasso_mse <- sum((X%*%(coef - beta))^2)"
"0",""
"0","# print(min_lambda_lasso_mse)"
"0","# print(min_lasso_mse)"
"0","plot(res[,2]~res[,1], log='x', main=""LASSO MSE for different values of lambda"")"
